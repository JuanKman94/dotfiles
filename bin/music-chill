#!/bin/bash

CMUS=$(pidof cmus)
FF=$(pidof firefox)
COMMAND='shutdown -h +1'

while [ "$1" != "" ]; do
    case $1 in
        s | --suspend)
            shift
            COMMAND='systemctl suspend'
            ;;
        *)
            echo Sleeping for $1 seconds before stopping...
            sleep $1
            ;;
    esac
    shift
done

# kill EVERYTHING >:D

if [ "$CMUS" != "" ]; then
    echo - Stoping cmus...
    cmus-remote --stop
    cmus-remote -C quit -i
fi

if [ "$FF" != "" ]; then
    echo - Killing firefox process...
    kill -9 $FF
fi

# Now stop n_n
$COMMAND
